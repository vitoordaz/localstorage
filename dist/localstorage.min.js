define("localstorage",["underscore"],function(a){"use strict";var b=function(a){var b=Array.prototype.slice.call(arguments,2);return setTimeout(function(){return a.apply(null,b)},1)},c=function(){},d=!1,e={},f=window.chrome&&chrome.storage&&chrome.storage.local;return f?{init:function(a){chrome.storage.local.get(null,function(b){e=b,d=!0,a()})},clear:function(a){if(!d)throw Error("localstorage.init was not called");a=a||c,chrome.storage.local.clear(a),e={}},setItem:function(a,b,f){if(!d)throw Error("localstorage.init was not called");f=f||c;var g={};g[a]=b,chrome.storage.local.set(g,f),e[a]=b},getItem:function(a,b){if(!d)throw Error("localstorage.init was not called");return b=b||c,chrome.storage.local.get(a,function(c){e[a]=c[a],b(c[a])}),e[a]},removeItem:function(a,b){if(!d)throw Error("localstorage.init was not called");b=b||c,chrome.storage.local.remove([a],b),delete e[a]}}:{init:b,clear:a.bind(localStorage.clear,localStorage),setItem:a.bind(localStorage.setItem,localStorage),getItem:a.bind(localStorage.getItem,localStorage),removeItem:a.bind(localStorage.removeItem,localStorage)}});